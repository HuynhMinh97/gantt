<div [ngClass]="classContainer">
  <div class="container_file">
    <ait-label [label]="getTitle()" [required]="required" *ngIf="getTitle()"></ait-label>

    <div
      class="containerx"
      appDnd
      (fileDropped)="onFileDropped($event)"
      *ngIf="!isLoading"
      (dragover)="onFileDropped()"
      (dragleave)="onFileDragLeave()"
      (mouseout)="onFileDragLeave()"
      [ngClass]="{ isError: isError }"
      style="cursor: pointer; margin-top: 8px"
      [ngStyle]="{ border: !isDefault ? '0.5px solid #000' : null }"
    >
      <p *ngIf="placeholder" [ngStyle]="{ color: !isDefault ? '#000' : null }">
        {{ placeholder }}
      </p>
      <p *ngIf="!placeholder" [ngStyle]="{ color: !isDefault ? '#000' : null }">
        {{ getPlaceHolder() }} &
        <span style="text-decoration: underline; text-transform: lowercase">{{
          getReference()
        }}</span
        >...
      </p>
      <input
        type="file"
        #fileDropRef
        id="fileDropRef"
        (click)="fileDropRef.value = null"
        [ngStyle]="{ color: !isDefault ? '#000' : null }"
        value=""
        (change)="fileBrowseHandler($event.target.files)"
        style="cursor: pointer"
      />
    </div>
    <ait-error-message [errors]="errors"></ait-error-message>
    <ait-error-message [errors]="[messageErrorFileSp]"></ait-error-message>

    <div class="information__file">
      <div class="icon" *ngIf="guidanceIcon && check()">
        <nb-icon [icon]="guidanceIcon" style="color: #8f9bb3"></nb-icon>
      </div>
      <div class="info empty">
        <p [ngStyle]="{ color: !isDefault ? '#000' : null }" *ngIf="guidance">
          {{ getNote() }}
        </p>
        <p *ngIf="maxFiles" [ngStyle]="{ color: !isDefault ? '#000' : null }">
          {{ getFileMaxUpload() || maxFiles }} {{ getMaxFileText() }}
        </p>
        <p *ngIf="fileTypes" [ngStyle]="{ color: !isDefault ? '#000' : null }">
          {{ getFileTypeSup() || fileTypes }} {{ getFileTypeText() }}
        </p>
      </div>
    </div>

    <div
      class="files-list"
      *ngIf="displayedFiles && displayedFiles.length !== 0"
    >
      <div
        class="single-file default"
        *ngFor="let file of displayedFiles; let i = index"
      >
        <div class="file-icon" style="width: 50px">
          <img
            *ngIf="(file?.file_type || '').includes('image')"
            id="{{ file?.name }}"
            [src]="safelyURL(file.data_base64, file.file_type)"
            alt=""
            (error)="image.src = '../../../../assets/images/not-f.jpg'"
            style="
              height: 45px;
              width: 45px;
              margin-right: 5px;
              object-fit: cover;
            "
            [nbTooltip]="file?.name"
          />
          <nb-icon
            *ngIf="!(file?.file_type || '').includes('image')"
            icon="attach-2-outline"
            style="font-size: 35px; color: #fff"
            [nbTooltip]="file?.name"
          ></nb-icon>
        </div>
        <div class="info">
          <p class="name" [ngStyle]="{ color: !isDefault ? '#000' : null }">
            {{ file?.name }} ({{ formatBytes(file?.size) }})
          </p>
          <p class="size" [ngStyle]="{ color: !isDefault ? '#000' : null }">
            {{ getTime(file?.create_at) }}
          </p>
        </div>

        <div class="delete" (click)="deleteFile(file, i)">
          <nb-icon
            icon="trash-2-outline"
            style="color: #8f9bb3"
            [nbTooltip]="getTextDelete()"
          ></nb-icon>
        </div>
      </div>
    </div>

    <div class="files-list">
      <div class="single-file" *ngFor="let file of fileDatas">
        <div class="file-icon" style="width: 50px">
          <img
            #image
            *ngIf="(file?.file_type || '').includes('image')"
            [src]="getSrc(file)"
            (error)="handleErrorImage(file)"
            alt=""
            srcset=""
            style="
              height: 38px;
              width: 38px;
              margin-right: 5px;
              object-fit: cover;
            "
          />
          <nb-icon
            *ngIf="!(file?.file_type || '').includes('image')"
            icon="attach-2-outline"
            style="font-size: 35px; color: #8f9bb3"
          ></nb-icon>
        </div>

        <div class="info">
          <p class="name" [ngStyle]="{ color: !isDefault ? '#000' : null }">
            {{ file?.name }}
          </p>
          <p class="size" [ngStyle]="{ color: !isDefault ? '#000' : null }">
            ({{ formatBytes(file?.size) }})
          </p>
          <p class="size" [ngStyle]="{ color: !isDefault ? '#000' : null }">
            {{ getTime(file.create_at) }}
          </p>
          <div class="progress-cont">
            <div
              class="progress"
              [style.height]="'10px'"
              [style.width]="file?.progress + '%'"
              [style.background]="'#00d68f'"
            ></div>
          </div>
        </div>

        <div class="delete" (click)="deleteFile(file, i)">
          <nb-icon icon="trash-2-outline" style="color: #8f9bb3"></nb-icon>
        </div>
      </div>
    </div>
  </div>
</div>
